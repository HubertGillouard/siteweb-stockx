{"ast":null,"code":"var _jsxFileName = \"/home/hubert/siteweb-stockx-main/sneakers-frontend/src/components/CheckoutForm.jsx\",\n  _s = $RefreshSig$();\nimport React, { useContext, useState } from \"react\";\nimport { CartContext } from \"../contexts/CartContext\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements, CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { createPayment, createOrder } from \"../api/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(\"pk_test_XXXXXXXXXXXXXXXXXXXX\");\nconst CheckoutFormInner = () => {\n  _s();\n  const {\n    cart,\n    subtotal,\n    clearCart\n  } = useContext(CartContext);\n  const stripe = useStripe();\n  const elements = useElements();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n    setLoading(true);\n    try {\n      const payRes = await createPayment({\n        amount: Math.round(subtotal * 100)\n      });\n      const {\n        client_secret\n      } = payRes.data;\n      const {\n        error\n      } = await stripe.confirmCardPayment(client_secret, {\n        payment_method: {\n          card: elements.getElement(CardElement)\n        }\n      });\n      if (error) throw error;\n      const items = cart.map(i => ({\n        productId: i.id,\n        qty: i.qty,\n        sku: i.sku,\n        size: i.size\n      }));\n      await createOrder({\n        items\n      });\n      clearCart();\n      setMessage(\"✅ Paiement et commande validés !\");\n    } catch (err) {\n      setMessage(`❌ ${err.message || \"Erreur paiement/commande\"}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    style: {\n      maxWidth: 420\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Total : \", subtotal.toFixed(2), \" \\u20AC\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CardElement, {\n      options: {\n        hidePostalCode: true,\n        style: {\n          base: {\n            fontSize: \"16px\"\n          }\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe || loading,\n      style: {\n        marginTop: 10\n      },\n      children: loading ? \"Paiement...\" : \"Payer maintenant\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), message && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 19\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 45,\n    columnNumber: 5\n  }, this);\n};\n_s(CheckoutFormInner, \"j4cdDm/qh6yOMV60OwZf1qmJ+lI=\", false, function () {\n  return [useStripe, useElements];\n});\n_c = CheckoutFormInner;\nexport default function CheckoutForm() {\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(CheckoutFormInner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n}\n_c2 = CheckoutForm;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutFormInner\");\n$RefreshReg$(_c2, \"CheckoutForm\");","map":{"version":3,"names":["React","useContext","useState","CartContext","loadStripe","Elements","CardElement","useStripe","useElements","createPayment","createOrder","jsxDEV","_jsxDEV","stripePromise","CheckoutFormInner","_s","cart","subtotal","clearCart","stripe","elements","loading","setLoading","message","setMessage","handleSubmit","e","preventDefault","payRes","amount","Math","round","client_secret","data","error","confirmCardPayment","payment_method","card","getElement","items","map","i","productId","id","qty","sku","size","err","onSubmit","style","maxWidth","children","toFixed","fileName","_jsxFileName","lineNumber","columnNumber","options","hidePostalCode","base","fontSize","type","disabled","marginTop","_c","CheckoutForm","_c2","$RefreshReg$"],"sources":["/home/hubert/siteweb-stockx-main/sneakers-frontend/src/components/CheckoutForm.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { CartContext } from \"../contexts/CartContext\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements, CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { createPayment, createOrder } from \"../api/api\";\n\nconst stripePromise = loadStripe(\"pk_test_XXXXXXXXXXXXXXXXXXXX\");\n\nconst CheckoutFormInner = () => {\n  const { cart, subtotal, clearCart } = useContext(CartContext);\n  const stripe = useStripe();\n  const elements = useElements();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState(\"\");\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n\n    setLoading(true);\n    try {\n      const payRes = await createPayment({ amount: Math.round(subtotal * 100) });\n      const { client_secret } = payRes.data;\n\n      const { error } = await stripe.confirmCardPayment(client_secret, {\n        payment_method: { card: elements.getElement(CardElement) }\n      });\n      if (error) throw error;\n\n      const items = cart.map(i => ({\n        productId: i.id, qty: i.qty, sku: i.sku, size: i.size\n      }));\n      await createOrder({ items });\n\n      clearCart();\n      setMessage(\"✅ Paiement et commande validés !\");\n    } catch (err) {\n      setMessage(`❌ ${err.message || \"Erreur paiement/commande\"}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} style={{ maxWidth: 420 }}>\n      <p>Total : {subtotal.toFixed(2)} €</p>\n      <CardElement options={{ hidePostalCode: true, style:{ base:{ fontSize:\"16px\" } } }} />\n      <button type=\"submit\" disabled={!stripe || loading} style={{ marginTop:10 }}>\n        {loading ? \"Paiement...\" : \"Payer maintenant\"}\n      </button>\n      {message && <p>{message}</p>}\n    </form>\n  );\n};\n\nexport default function CheckoutForm() {\n  return (\n    <Elements stripe={stripePromise}>\n      <CheckoutFormInner />\n    </Elements>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}