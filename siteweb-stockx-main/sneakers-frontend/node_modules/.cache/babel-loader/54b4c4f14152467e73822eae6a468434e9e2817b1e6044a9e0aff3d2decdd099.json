{"ast":null,"code":"var _jsxFileName = \"/home/hubert/siteweb-stockx-main/sneakers-frontend/src/contexts/CartContext.jsx\",\n  _s = $RefreshSig$();\nimport React, { createContext, useMemo, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const CartContext = /*#__PURE__*/createContext();\nexport function CartProvider({\n  children\n}) {\n  _s();\n  const [cart, setCart] = useState(() => {\n    try {\n      return JSON.parse(localStorage.getItem(\"cart\") || \"[]\");\n    } catch {\n      return [];\n    }\n  });\n  const persist = next => {\n    setCart(next);\n    localStorage.setItem(\"cart\", JSON.stringify(next));\n  };\n  const addToCart = (product, sku = null, qty = 1) => {\n    persist(prev => {\n      const key = `${product.id}:${sku || \"\"}`;\n      const found = prev.find(i => i.key === key);\n      if (found) {\n        return prev.map(i => i.key === key ? {\n          ...i,\n          qty: i.qty + qty\n        } : i);\n      }\n      return [...prev, {\n        key,\n        productId: product.id,\n        name: product.name,\n        price: Number(product.price),\n        sku,\n        qty\n      }];\n    });\n  };\n  const removeFromCart = key => {\n    persist(cart.filter(i => i.key !== key));\n  };\n  const updateQty = (key, qty) => {\n    if (qty <= 0) return removeFromCart(key);\n    persist(cart.map(i => i.key === key ? {\n      ...i,\n      qty\n    } : i));\n  };\n  const clearCart = () => persist([]);\n  const subtotal = useMemo(() => cart.reduce((s, i) => s + Number(i.price) * i.qty, 0), [cart]);\n  const totalItems = useMemo(() => cart.reduce((s, i) => s + i.qty, 0), [cart]);\n\n  // pour compatibilité avec ton ancien code\n  const totalPrice = () => subtotal;\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      cart,\n      addToCart,\n      removeFromCart,\n      updateQty,\n      clearCart,\n      subtotal,\n      totalItems,\n      totalPrice\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 5\n  }, this);\n}\n_s(CartProvider, \"PY4WLuDF2H9tlkmNcjaRo5duvVo=\");\n_c = CartProvider;\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useMemo","useState","jsxDEV","_jsxDEV","CartContext","CartProvider","children","_s","cart","setCart","JSON","parse","localStorage","getItem","persist","next","setItem","stringify","addToCart","product","sku","qty","prev","key","id","found","find","i","map","productId","name","price","Number","removeFromCart","filter","updateQty","clearCart","subtotal","reduce","s","totalItems","totalPrice","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/hubert/siteweb-stockx-main/sneakers-frontend/src/contexts/CartContext.jsx"],"sourcesContent":["import React, { createContext, useMemo, useState } from \"react\";\n\nexport const CartContext = createContext();\n\nexport function CartProvider({ children }) {\n  const [cart, setCart] = useState(() => {\n    try { return JSON.parse(localStorage.getItem(\"cart\") || \"[]\"); } catch { return []; }\n  });\n\n  const persist = (next) => {\n    setCart(next);\n    localStorage.setItem(\"cart\", JSON.stringify(next));\n  };\n\n  const addToCart = (product, sku = null, qty = 1) => {\n    persist(prev => {\n      const key = `${product.id}:${sku||\"\"}`;\n      const found = prev.find(i => i.key === key);\n      if (found) {\n        return prev.map(i => i.key === key ? { ...i, qty: i.qty + qty } : i);\n      }\n      return [...prev, {\n        key,\n        productId: product.id,\n        name: product.name,\n        price: Number(product.price),\n        sku,\n        qty\n      }];\n    });\n  };\n\n  const removeFromCart = (key) => {\n    persist(cart.filter(i => i.key !== key));\n  };\n\n  const updateQty = (key, qty) => {\n    if (qty <= 0) return removeFromCart(key);\n    persist(cart.map(i => i.key === key ? { ...i, qty } : i));\n  };\n\n  const clearCart = () => persist([]);\n\n  const subtotal = useMemo(() => cart.reduce((s, i) => s + Number(i.price) * i.qty, 0), [cart]);\n  const totalItems = useMemo(() => cart.reduce((s, i) => s + i.qty, 0), [cart]);\n\n  // pour compatibilité avec ton ancien code\n  const totalPrice = () => subtotal;\n\n  return (\n    <CartContext.Provider value={{\n      cart, addToCart, removeFromCart, updateQty, clearCart,\n      subtotal, totalItems, totalPrice\n    }}>\n      {children}\n    </CartContext.Provider>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}