{"ast":null,"code":"var _jsxFileName = \"/home/hubert/siteweb-stockx-main/sneakers-frontend/src/components/CheckoutForm.jsx\",\n  _s = $RefreshSig$();\nimport React, { useContext, useState } from \"react\";\nimport { CartContext } from \"../contexts/CartContext\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements, CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\n\n// Ta clé publique Stripe (test)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(\"pk_test_XXXXXXXXXXXXXXXXXXXX\");\nconst CheckoutFormInner = () => {\n  _s();\n  const {\n    cart,\n    subtotal,\n    clearCart\n  } = useContext(CartContext);\n  const stripe = useStripe();\n  const elements = useElements();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n    setLoading(true);\n    try {\n      // 1️⃣ Crée un paiement côté serveur\n      const res = await fetch(\"http://localhost:4000/api/payments\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          amount: subtotal\n        })\n      });\n      const paymentData = await res.json();\n      if (!res.ok) throw new Error(paymentData.message || \"Erreur paiement\");\n\n      // 2️⃣ Confirm payment via Stripe (simulé)\n      const {\n        error\n      } = await stripe.confirmCardPayment(paymentData.client_secret, {\n        payment_method: {\n          card: elements.getElement(CardElement)\n        }\n      });\n      if (error) throw error;\n      clearCart();\n      setMessage(\"✅ Paiement effectué avec succès !\");\n    } catch (err) {\n      console.error(err);\n      setMessage(`❌ Erreur : ${err.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    style: {\n      maxWidth: 400\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Total : \", subtotal.toFixed(2), \" \\u20AC\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CardElement, {\n      options: {\n        hidePostalCode: true,\n        style: {\n          base: {\n            fontSize: \"16px\"\n          }\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe || loading,\n      style: {\n        marginTop: 10\n      },\n      children: loading ? \"Paiement...\" : \"Payer maintenant\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), message && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 19\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n};\n_s(CheckoutFormInner, \"j4cdDm/qh6yOMV60OwZf1qmJ+lI=\", false, function () {\n  return [useStripe, useElements];\n});\n_c = CheckoutFormInner;\nexport default function CheckoutForm() {\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(CheckoutFormInner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n}\n_c2 = CheckoutForm;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutFormInner\");\n$RefreshReg$(_c2, \"CheckoutForm\");","map":{"version":3,"names":["React","useContext","useState","CartContext","loadStripe","Elements","CardElement","useStripe","useElements","jsxDEV","_jsxDEV","stripePromise","CheckoutFormInner","_s","cart","subtotal","clearCart","stripe","elements","loading","setLoading","message","setMessage","handleSubmit","e","preventDefault","res","fetch","method","headers","body","JSON","stringify","amount","paymentData","json","ok","Error","error","confirmCardPayment","client_secret","payment_method","card","getElement","err","console","onSubmit","style","maxWidth","children","toFixed","fileName","_jsxFileName","lineNumber","columnNumber","options","hidePostalCode","base","fontSize","type","disabled","marginTop","_c","CheckoutForm","_c2","$RefreshReg$"],"sources":["/home/hubert/siteweb-stockx-main/sneakers-frontend/src/components/CheckoutForm.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { CartContext } from \"../contexts/CartContext\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport {\n  Elements,\n  CardElement,\n  useStripe,\n  useElements\n} from \"@stripe/react-stripe-js\";\n\n// Ta clé publique Stripe (test)\nconst stripePromise = loadStripe(\"pk_test_XXXXXXXXXXXXXXXXXXXX\");\n\nconst CheckoutFormInner = () => {\n  const { cart, subtotal, clearCart } = useContext(CartContext);\n  const stripe = useStripe();\n  const elements = useElements();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState(\"\");\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n\n    setLoading(true);\n    try {\n      // 1️⃣ Crée un paiement côté serveur\n      const res = await fetch(\"http://localhost:4000/api/payments\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ amount: subtotal })\n      });\n      const paymentData = await res.json();\n\n      if (!res.ok) throw new Error(paymentData.message || \"Erreur paiement\");\n\n      // 2️⃣ Confirm payment via Stripe (simulé)\n      const { error } = await stripe.confirmCardPayment(paymentData.client_secret, {\n        payment_method: { card: elements.getElement(CardElement) }\n      });\n\n      if (error) throw error;\n\n      clearCart();\n      setMessage(\"✅ Paiement effectué avec succès !\");\n    } catch (err) {\n      console.error(err);\n      setMessage(`❌ Erreur : ${err.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} style={{ maxWidth: 400 }}>\n      <p>Total : {subtotal.toFixed(2)} €</p>\n      <CardElement options={{ hidePostalCode: true, style: { base: { fontSize: \"16px\" } } }} />\n      <button type=\"submit\" disabled={!stripe || loading} style={{ marginTop: 10 }}>\n        {loading ? \"Paiement...\" : \"Payer maintenant\"}\n      </button>\n      {message && <p>{message}</p>}\n    </form>\n  );\n};\n\nexport default function CheckoutForm() {\n  return (\n    <Elements stripe={stripePromise}>\n      <CheckoutFormInner />\n    </Elements>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}