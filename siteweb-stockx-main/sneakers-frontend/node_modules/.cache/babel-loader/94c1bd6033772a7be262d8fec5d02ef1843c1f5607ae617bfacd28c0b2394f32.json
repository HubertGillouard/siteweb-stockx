{"ast":null,"code":"var _jsxFileName = \"/home/hubert/siteweb-stockx-main/sneakers-frontend/src/components/CheckoutForm.jsx\",\n  _s = $RefreshSig$();\nimport React, { useContext, useState } from \"react\";\nimport { CartContext } from \"../contexts/CartContext\";\nimport { createPayment, createOrder } from \"../api/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CheckoutForm() {\n  _s();\n  const {\n    cart,\n    subtotal,\n    clearCart\n  } = useContext(CartContext);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!cart.length) return setMessage(\"Panier vide.\");\n    setLoading(true);\n    try {\n      var _pay$data;\n      // 1) Paiement simulé (fictif)\n      const pay = await createPayment({\n        amount: Math.round(subtotal * 100)\n      });\n      if (!((_pay$data = pay.data) !== null && _pay$data !== void 0 && _pay$data.client_secret)) throw new Error(\"Échec du paiement fictif\");\n\n      // 2) Création commande\n      const items = cart.map(i => ({\n        productId: i.productId,\n        sku: i.sku || null,\n        qty: i.qty\n      }));\n      const order = await createOrder({\n        items\n      });\n      clearCart();\n      setMessage(`✅ Paiement OK • Commande #${order.data.id} — total ${order.data.total} €`);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(err);\n      setMessage(`❌ Erreur : ${((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    style: {\n      maxWidth: 420\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Total : \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: [subtotal.toFixed(2), \" \\u20AC\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 18\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        fontSize: 12,\n        opacity: 0.8\n      },\n      children: \"(Paiement fictif : aucune carte r\\xE9elle requise)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: loading,\n      children: loading ? \"Paiement...\" : \"Payer maintenant\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), message && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        marginTop: 10\n      },\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 19\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 39,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutForm, \"e2Pmnwd/LBGLvWD5qDtiXU3lX6A=\");\n_c = CheckoutForm;\nvar _c;\n$RefreshReg$(_c, \"CheckoutForm\");","map":{"version":3,"names":["React","useContext","useState","CartContext","createPayment","createOrder","jsxDEV","_jsxDEV","CheckoutForm","_s","cart","subtotal","clearCart","loading","setLoading","message","setMessage","handleSubmit","e","preventDefault","length","_pay$data","pay","amount","Math","round","data","client_secret","Error","items","map","i","productId","sku","qty","order","id","total","err","_err$response","_err$response$data","console","error","response","onSubmit","style","maxWidth","children","toFixed","fileName","_jsxFileName","lineNumber","columnNumber","fontSize","opacity","type","disabled","marginTop","_c","$RefreshReg$"],"sources":["/home/hubert/siteweb-stockx-main/sneakers-frontend/src/components/CheckoutForm.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { CartContext } from \"../contexts/CartContext\";\nimport { createPayment, createOrder } from \"../api/api\";\n\nexport default function CheckoutForm() {\n  const { cart, subtotal, clearCart } = useContext(CartContext);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState(\"\");\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!cart.length) return setMessage(\"Panier vide.\");\n\n    setLoading(true);\n    try {\n      // 1) Paiement simulé (fictif)\n      const pay = await createPayment({ amount: Math.round(subtotal * 100) });\n      if (!pay.data?.client_secret) throw new Error(\"Échec du paiement fictif\");\n\n      // 2) Création commande\n      const items = cart.map(i => ({\n        productId: i.productId,\n        sku: i.sku || null,\n        qty: i.qty\n      }));\n      const order = await createOrder({ items });\n\n      clearCart();\n      setMessage(`✅ Paiement OK • Commande #${order.data.id} — total ${order.data.total} €`);\n    } catch (err) {\n      console.error(err);\n      setMessage(`❌ Erreur : ${err.response?.data?.message || err.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} style={{ maxWidth: 420 }}>\n      <p>Total : <b>{subtotal.toFixed(2)} €</b></p>\n      <p style={{ fontSize: 12, opacity: 0.8 }}>\n        (Paiement fictif : aucune carte réelle requise)\n      </p>\n      <button type=\"submit\" disabled={loading}>\n        {loading ? \"Paiement...\" : \"Payer maintenant\"}\n      </button>\n      {message && <p style={{ marginTop: 10 }}>{message}</p>}\n    </form>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}