{"ast":null,"code":"var _jsxFileName = \"/home/hubert/siteweb-stockx-main/sneakers-frontend/src/pages/Checkout.jsx\",\n  _s = $RefreshSig$();\n// src/pages/Checkout.jsx\nimport React, { useContext, useState } from \"react\";\nimport { CartContext } from \"../contexts/CartContext\";\nimport { createOrder, createPayment } from \"../api/api\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Checkout() {\n  _s();\n  const {\n    cart,\n    clearCart,\n    totalPrice\n  } = useContext(CartContext);\n  const [loading, setLoading] = useState(false);\n  const [success, setSuccess] = useState(false);\n  const navigate = useNavigate();\n  const handlePayment = async () => {\n    if (cart.length === 0) return alert(\"Votre panier est vide !\");\n    setLoading(true);\n    try {\n      // 1️⃣ Créer la commande dans ton backend\n      const orderData = {\n        items: cart.map(p => ({\n          productId: p.id,\n          quantity: 1\n        })),\n        total: totalPrice\n      };\n      const orderRes = await createOrder(orderData);\n\n      // 2️⃣ Créer le paiement via Stripe\n      const paymentRes = await createPayment({\n        orderId: orderRes.data.id,\n        amount: totalPrice * 100 // Stripe en cents\n      });\n\n      // 3️⃣ Redirection vers Stripe Checkout\n      window.location.href = paymentRes.data.url;\n\n      // 4️⃣ Après paiement réussi, tu peux clear le panier\n      clearCart();\n      setSuccess(true);\n    } catch (err) {\n      console.error(err);\n      alert(\"Erreur lors du paiement. Réessayez plus tard.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  if (success) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: 20,\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u2705 Paiement r\\xE9ussi !\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Merci pour votre commande. Vous allez recevoir un email de confirmation.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate(\"/\"),\n        children: \"Retour \\xE0 l\\u2019accueil\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: 800,\n      margin: \"2rem auto\",\n      padding: 20\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"R\\xE9sum\\xE9 de votre commande\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), cart.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Votre panier est vide.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n        children: cart.map(item => /*#__PURE__*/_jsxDEV(\"li\", {\n          style: {\n            marginBottom: 10\n          },\n          children: [item.name, \" - \", item.price.toFixed(2), \" \\u20AC\"]\n        }, item.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Total : \", totalPrice.toFixed(2), \" \\u20AC\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handlePayment,\n        disabled: loading,\n        children: loading ? \"Traitement...\" : \"Payer avec Stripe\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n_s(Checkout, \"XfGCu01Dd/xK3MyKy4kWRC3csKg=\", false, function () {\n  return [useNavigate];\n});\n_c = Checkout;\nvar _c;\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"names":["React","useContext","useState","CartContext","createOrder","createPayment","useNavigate","jsxDEV","_jsxDEV","Checkout","_s","cart","clearCart","totalPrice","loading","setLoading","success","setSuccess","navigate","handlePayment","length","alert","orderData","items","map","p","productId","id","quantity","total","orderRes","paymentRes","orderId","data","amount","window","location","href","url","err","console","error","style","padding","textAlign","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","maxWidth","margin","item","marginBottom","name","price","toFixed","disabled","_c","$RefreshReg$"],"sources":["/home/hubert/siteweb-stockx-main/sneakers-frontend/src/pages/Checkout.jsx"],"sourcesContent":["// src/pages/Checkout.jsx\nimport React, { useContext, useState } from \"react\";\nimport { CartContext } from \"../contexts/CartContext\";\nimport { createOrder, createPayment } from \"../api/api\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function Checkout() {\n  const { cart, clearCart, totalPrice } = useContext(CartContext);\n  const [loading, setLoading] = useState(false);\n  const [success, setSuccess] = useState(false);\n  const navigate = useNavigate();\n\n  const handlePayment = async () => {\n    if (cart.length === 0) return alert(\"Votre panier est vide !\");\n    setLoading(true);\n\n    try {\n      // 1️⃣ Créer la commande dans ton backend\n      const orderData = {\n        items: cart.map((p) => ({ productId: p.id, quantity: 1 })),\n        total: totalPrice,\n      };\n      const orderRes = await createOrder(orderData);\n\n      // 2️⃣ Créer le paiement via Stripe\n      const paymentRes = await createPayment({\n        orderId: orderRes.data.id,\n        amount: totalPrice * 100, // Stripe en cents\n      });\n\n      // 3️⃣ Redirection vers Stripe Checkout\n      window.location.href = paymentRes.data.url;\n\n      // 4️⃣ Après paiement réussi, tu peux clear le panier\n      clearCart();\n      setSuccess(true);\n    } catch (err) {\n      console.error(err);\n      alert(\"Erreur lors du paiement. Réessayez plus tard.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (success) {\n    return (\n      <div style={{ padding: 20, textAlign: \"center\" }}>\n        <h2>✅ Paiement réussi !</h2>\n        <p>Merci pour votre commande. Vous allez recevoir un email de confirmation.</p>\n        <button onClick={() => navigate(\"/\")}>Retour à l’accueil</button>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ maxWidth: 800, margin: \"2rem auto\", padding: 20 }}>\n      <h1>Résumé de votre commande</h1>\n      {cart.length === 0 ? (\n        <p>Votre panier est vide.</p>\n      ) : (\n        <div>\n          <ul>\n            {cart.map((item) => (\n              <li key={item.id} style={{ marginBottom: 10 }}>\n                {item.name} - {item.price.toFixed(2)} €\n              </li>\n            ))}\n          </ul>\n          <h3>Total : {totalPrice.toFixed(2)} €</h3>\n          <button onClick={handlePayment} disabled={loading}>\n            {loading ? \"Traitement...\" : \"Payer avec Stripe\"}\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}